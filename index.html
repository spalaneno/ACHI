<script>
const API_URL = "https://script.google.com/macros/s/AKfycby_b4fYF2fCP6vwKzCEIWpHbfTd472de9cJVWx-ulrVOBG2aU4Jixj1YWLiTdhiWcUC/exec";

function login() {
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();
  const status = document.getElementById("status");

  status.innerText = "Menghubungkan...";

  fetch(`${API_URL}?username=${encodeURIComponent(u)}&password=${encodeURIComponent(p)}`)
    .then(res => res.json())
    .then(data => {
      if (data.status === "success") {
        localStorage.setItem("achi_login", "true");
        localStorage.setItem("achi_user", data.username);
        localStorage.setItem("achi_role", data.role);
        localStorage.setItem("achi_kapal", data.kapal);
        localStorage.setItem("achi_nama", data.nama);

        status.innerText = "Login berhasil...";
        setTimeout(() => {
          if (data.role === "ABK") window.location.href = "abk.html";
          else if (data.role === "KAPTEN") window.location.href = "kapten.html";
          else if (data.role === "CHIEF") window.location.href = "engine.html";
          else if (data.role === "ADMIN") window.location.href = "admin.html";
          else if (data.role === "OWNER") window.location.href = "owner.html";
        }, 600);
      } else {
        status.innerText = "Username / Password salah";
      }
    })
    .catch(() => {
      status.innerText = "Gagal koneksi ke server";
    });
}
</script>
