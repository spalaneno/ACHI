<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ADMIN – APPROVAL ANFRAKAN</title>

<style>
body {
  background: #0e0e0e;
  color: #fff;
  font-family: Arial;
}
header {
  background: linear-gradient(90deg, #8b0000, #ff0000);
  padding: 15px;
  text-align: center;
  font-size: 22px;
  font-weight: bold;
}
table {
  width: 95%;
  margin: 20px auto;
  border-collapse: collapse;
}
th, td {
  border: 1px solid #444;
  padding: 10px;
  text-align: center;
}
th {
  background: #b30000;
}
button {
  padding: 6px 10px;
  margin: 2px;
  cursor: pointer;
}
.approve { background: green; color: #fff; }
.reject { background: red; color: #fff; }
</style>
</head>

<body>

<header>ADMIN – APPROVAL ANFRAKAN</header>

<table>
<thead>
<tr>
  <th>Tanggal</th>
  <th>Kapal</th>
  <th>User</th>
  <th>Keterangan</th>
  <th>Nominal</th>
  <th>Aksi</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>

<script>
const API = "https://script.google.com/macros/s/AKfycbxh4rEWK9NyUVOl6o7ndt8sGBxOG8mwFhrY6pz5xL9I5QM3-o1rh1Ina1OtuPmFpw50/exec";

fetch(API + "?action=getPendingAnfrakan")
.then(r => r.json())
.then(res => {
  if (!res.data || res.data.length === 0) {
    document.getElementById("data").innerHTML =
      "<tr><td colspan='6'>Tidak ada anfrakan pending</td></tr>";
    return;
  }

  let html = "";
  res.data.forEach(d => {
    html += `
      <tr>
        <td>${d.tanggal}</td>
        <td>${d.kapal}</td>
        <td>${d.username}</td>
        <td>${d.keterangan}</td>
        <td>${d.nominal}</td>
        <td>
          <button class="approve" onclick="update(${d.row},'APPROVED')">✔</button>
          <button class="reject" onclick="update(${d.row},'REJECTED')">✖</button>
        </td>
      </tr>`;
  });
  document.getElementById("data").innerHTML = html;
});

function update(row, status) {
  fetch(API, {
    method: "POST",
    body: JSON.stringify({
      action: "updateStatus",
      row: row,
      status: status
    })
  })
  .then(r => r.json())
  .then(() => location.reload());
}
</script>

</body>
</html>
