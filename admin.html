<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>ADMIN – APPROVAL ANFRAKAN</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #111;
  color: #fff;
}

header {
  padding: 20px;
  background: linear-gradient(90deg, #b30000, #000);
  text-align: center;
  font-size: 22px;
  font-weight: bold;
}

#list {
  padding: 20px;
}

.card {
  background: #1e1e1e;
  padding: 15px;
  margin-bottom: 15px;
  border-left: 5px solid #b30000;
}

button {
  margin-top: 10px;
  padding: 8px 14px;
  background: #b30000;
  border: none;
  color: white;
  cursor: pointer;
}

button:hover {
  background: #ff0000;
}
</style>
</head>

<body>

<header>ADMIN – APPROVAL ANFRAKAN</header>
<div id="list">Memuat data...</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyWSaiHkC7izmB6Lfn9DKTB8mUK2Xc7dmhOalNQ8RlmSbQ5WbQPwvLjLFxW1mr6_A7M/exec";

fetch(API_URL + "?action=getPendingAnfrakan")
  .then(response => response.json())
  .then(res => {

    const container = document.getElementById("list");

    if (!res.data || res.data.length === 0) {
      container.innerHTML = "<p>Tidak ada anfrakan pending</p>";
      return;
    }

    let html = "";
    res.data.forEach(item => {
      html += `
        <div style="border:1px solid #444;padding:12px;margin-bottom:10px">
          <b>Kapal:</b> ${item.kapal}<br>
          <b>Keterangan:</b> ${item.keterangan}<br>
          <b>Nominal:</b> Rp ${item.nominal.toLocaleString()}<br>
          <button onclick="approve(${item.row})">APPROVE</button>
        </div>
      `;
    });

    container.innerHTML = html;
  })
  .catch(err => {
    document.getElementById("list").innerHTML =
      "Gagal memuat data: " + err;
  });

function approve(row) {
  fetch(API_URL + "?action=approve&row=" + row + "&admin=ADMIN")
    .then(res => res.json())
    .then(() => {
      alert("Anfrakan disetujui");
      location.reload();
    });
}
</script>

</body>
</html>
